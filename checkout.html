<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Knotty Yarn</title>
  <link rel="stylesheet" href="items.css">
  <link rel="stylesheet" href=
"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <script src=
"https://code.jquery.com/jquery-3.6.0.min.js">
    </script>
    <script src=
"https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.12/typed.min.js">
    </script>
    <script src=
"https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js">
    </script>
    <script src=
"https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js">
    </script>
 
    <link rel="stylesheet" href=
"https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="checkout.css">
  <script type="text/javascript"
        src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
</script>
<script type="text/javascript">
   (function(){
      emailjs.init({
        publicKey: "E7fSGypHRdQ7OZmwd",
      });
   })();
</script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/boxicons/2.0.7/css/boxicons.min.css" rel="stylesheet">

<link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css">
  <link type="image/png" sizes="16x16" rel="icon" href="./Images/icons8-k-16.png">
<style>
  @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        body {
            opacity: 0;
            animation: fadeIn 1s ease-in-out forwards;
        }
        #altToggleButton {
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
    position: relative; /* Position the tooltip relative to the button */
}

#altToggleButton svg {
    fill: currentColor;
    width: 24px;
    height: 24px;
}

#altToggleButton:hover svg {
    color: #007BFF; /* Hover color for icon */
}

.tooltip {
    display: none;
    position: absolute;
    bottom: 30px; /* Position the tooltip below the button */
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.75);
    color: white;
    padding: 5px;
    border-radius: 5px;
    font-size: 12px;
    white-space: nowrap;
}

#altToggleButton:hover .tooltip {
    display: block; /* Show the tooltip when the button is hovered */
}
/* Apply a custom font and italicize the product names */
.product-name {
    font-family: 'Arial', sans-serif; /* Change to any custom font you prefer */
    font-style: italic;
    font-size: 15px;
  
}
.product-price{
  font-family: 'Arial', sans-serif; /* Change to any custom font you prefer */
    font-style: italic;
    font-size: 15px;
  
}
.product-color{
  font-family: 'Arial', sans-serif; /* Change to any custom font you prefer */
    font-style: italic;
    font-size: 15px;
  
}
.product-quantity{
  font-family: 'Arial', sans-serif; /* Change to any custom font you prefer */
    font-style: italic;
    font-size: 15px;
  
}
.product-total{
  font-family: 'Arial', sans-serif; /* Change to any custom font you prefer */
    font-style: italic;
    font-size: 15px;
  
}

/* Phone Number Input Field */
input[type="tel"] {
    padding: 12px;
    font-size: 16px;
    border: 1px solid #ddd;
    border-radius: 6px;
    background-color: #f1f1f1;
    transition: all 0.3s ease;
    width: 100%;
}

input[type="tel"]:focus {
    border-color: #ff6f61;
    background-color: #fff;
    outline: none;
}

/* Label Styling for Phone Number */
label[for="phone"] {
    font-weight: bold;
    font-size: 16px;
    margin-bottom: 5px;
    color: #333;
}
/* Payment Method Section */
.form-group {
    margin-bottom: 20px;
}

label {
    font-size: 1.1rem;
    margin-bottom: 8px;
    color: #333;
}

select,
input[type="file"],
input[type="text"] {
    width: 100%;
    padding: 12px;
    border-radius: 6px;
    font-size: 1rem;
    border: 1px solid #ccc;
    transition: border-color 0.3s ease;
}

select:focus,
input[type="file"]:focus,
input[type="text"]:focus {
    border-color: #ff00ff;
    outline: none;
}

select {
    background-color: #f9f9f9;
}

input[type="file"] {
    background-color: #f0f0f0;
    padding: 10px;
}

input[type="text"] {
    background-color: #f9f9f9;
}

input[type="file"]:hover {
    background-color: #e6e6e6;
}

input[type="text"]:hover {
    background-color: #e6e6e6;
}

/* Payment Details Section */
#payment-details {
    margin-top: 20px;
    padding: 20px;
    border-radius: 8px;
    background-color: #f7f7f7;
    border: 1px solid #ddd;
    display: none;
}

#payment-details label {
    font-size: 1rem;
    margin-bottom: 10px;
    display: block;
    color: #333;
}

#payment-upload,
#payment-reference {
    margin-bottom: 20px;
}

#payment-upload input,
#payment-reference input {
    padding: 12px;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 1rem;
    width: 100%;
    transition: border-color 0.3s ease;
}

#payment-upload input:focus,
#payment-reference input:focus {
    border-color: #ff00ff;
    outline: none;
}

#payment-upload input {
    background-color: #f0f0f0;
}

#payment-reference input {
    background-color: #f9f9f9;
}

#payment-details {
    display: none;
}

/* Responsive Styles */
@media (max-width: 768px) {
    .form-group {
        margin-bottom: 15px;
    }

    select,
    input[type="file"],
    input[type="text"] {
        padding: 10px;
        font-size: 1rem;
    }
}

</style>
</head>
<div class="fade-on-scroll"></div>
<body>
  <nav class="navbar">
    <div class="header-container">
        <!-- Logo -->
        <div class="logo">
            <a href="index.html">
                <img src="./Images/yarnnlogo.png" alt="Knotty Yarn Logo">
            </a>
        </div>

        <!-- Mobile Menu Button -->
        <button class="menu-btn" id="menu-btn" aria-label="Toggle Menu">
          <div class="bar"></div>
          <div class="bar"></div>
          <div class="bar"></div>
      </button>

        <!-- Navigation Menus -->
        <ul class="menu left-menu">
            <li><a href="index.html"><i class='bx bx-home'></i> Home</a></li>
            <li><a href="shop.html"><i class='bx bx-store'></i> Shop</a></li>
            <li><a href="about.html"><i class='bx bx-info-circle'></i> About</a></li>
            <li><a href="contact.html"><i class='bx bx-envelope'></i> Contact</a></li>
            <li><a id="dark-mode-toggle"><i class='bx bx-moon'></i></a></li>
        </ul>

        <ul class="menu right-menu">
            <li><a href="cart.html"><i class='bx bx-cart'></i></a></li>
            <li><button id="music-toggle"><i class='bx bx-music'></i></button></li>
            <li>
                <button id="altToggleButton" class="menu-button">
                    <i class='bx bx-universal-access'></i>
                    <span class="tooltip">Enable/Disable Text Speech</span>
                </button>
            </li>
        </ul>
    </div>
</nav>

    <!-- Background Music -->
    <audio id="background-music" loop>
        <source src="natsuki.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>
    
    <br><br><br><br>
  <center>
      <div class="checkout-container">
        <h1 class="glowing-text">Checkout</h1>
      
        <div class="cart-summary">
          <h2>Your Cart</h2>
          <ul id="cart-items"></ul>
          <p id="total-price"></p>
        </div>
      
        <form id="checkout-form">
          <div class="form-group">
            <label for="name">Name</label>
            <input type="text" id="name" name="name" placeholder="Enter your full name" required>
          </div>
        
          <div class="form-group">
            <label for="address">Address</label>
            <textarea id="address" name="address" placeholder="Enter your address" required></textarea>
          </div>
        
          <div class="form-group">
            <label for="phone">Phone Number</label>
            <input type="tel" id="phone" name="phone" placeholder="Enter your phone number" required pattern="[0-9]{11}">
            
          </div>
        
          <!-- Payment Method -->
<div class="form-group">
  <label for="payment-method">Payment Method</label>
  <select id="payment-method" name="payment-method" required onchange="showPaymentFields()">
    <option value="">-- Select Payment Method --</option>
    <option value="gcash">Gcash</option>
    <option value="cod">Cash on Delivery (COD)</option>
  </select>
</div>

<!-- Payment Reference or Image Upload Section -->
<div id="payment-details" style="display: none;">
  <div id="payment-upload">
    <label for="payment-image">Upload Payment Image</label>
    <input type="file" id="payment-image" name="payment-image" accept="image/*">
  </div>
  
 
</div>

          <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" name="email" placeholder="Enter your email" required>
          </div>
        
          <!-- ðŸ§µ Customization Section ðŸ§µ -->
          <div class="form-group">
            <label for="customization">Customization Request (Optional)</label>
            <textarea id="customization" name="customization" placeholder="Describe your custom order details here..."></textarea>
          </div>
        
          <p>By using this website, you agree to our <a href="#" id="privacy-link">Privacy Policy</a>.</p>
          <br>
        
          <div class="form-group">
            <input type="submit" value="Confirm Purchase">
          </div>
        </form>
        
    <p id="success-message" style="color: green; display: none;">Order submitted successfully!</p>
  </div>
        </form>
        
    </center>
    
  <!-- The Modal -->
  <div id="privacyModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <span class="close">&times;</span>
        <h2>Data Privacy Policy</h2>
      </div>
      <div class="modal-body">
        <h3>Your Privacy is Important to Us</h3> <br>
        <p>At <strong>Knotty Yarn</strong>, we are committed to protecting your privacy. This Data Privacy Act explains how we collect, use, and protect your personal information.</p>
<br>
        <h4>1. What Information We Collect</h4>
        <p>We collect personal information such as your name, email address, delivery address, and payment details.</p>
<br>
        <h4>2. How We Use Your Information</h4>
        <p>Your information is used to process orders, provide customer support, and send order confirmations.</p>
<br>
        <h4>3. Data Security</h4>
        <p>We use industry-standard encryption to protect your data. While we take great care to safeguard your personal information, no method of electronic storage is 100% secure.</p>
<br>
        <h4>4. Cookies and Tracking</h4>
        <p>We use cookies to improve your user experience. You can disable cookies through your browser settings.</p>
<br>
        <h4>5. Third-Party Services</h4>
        <p>We may share your information with third-party services that help us process your orders and deliver services, such as payment processors and shipping providers.</p>
<br>
        <h4>6. Your Rights</h4>
        <p>You have the right to access, modify, or delete your personal data. Contact us at knottyyarn.ph@gmail.com for assistance.</p>
<br>
        <h4>7. Changes to This Policy</h4>
        <p>We may update this policy. Changes will be posted on this page.</p>
      </div>
      <div class="modal-footer">
        <button class="btn" id="acceptBtn">Accept</button>
      </div>
    </div>
  </div>

  <script>
    // Get the modal
    var modal = document.getElementById("privacyModal");

    // Get the link that opens the modal
    var privacyLink = document.getElementById("privacy-link");

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];

    // Get the "Accept" button
    var acceptBtn = document.getElementById("acceptBtn");

    // When the user clicks on the link, open the modal
    privacyLink.onclick = function(event) {
      event.preventDefault(); // Prevent default link behavior
      modal.style.display = "block"; // Show the modal
    }

    // When the user clicks on the "Accept" button, close the modal and store consent
    acceptBtn.onclick = function() {
      modal.style.display = "none";
      // Optionally store consent in localStorage or cookies
      localStorage.setItem('privacyAccepted', 'true');
    }

    // When the user clicks on the <span> (x), close the modal
    span.onclick = function() {
      modal.style.display = "none";
    }

    // When the user clicks anywhere outside the modal, close it
    window.onclick = function(event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    }

    // Check if the user has already accepted the privacy policy
    window.onload = function() {
      if (!localStorage.getItem('privacyAccepted')) {
        // Optionally show modal if not accepted
      }
    }
  </script>

      <script>
// Function to format the price with peso (â‚±)
function formatPeso(amount) {
    return 'â‚±' + amount.toFixed(2); // Ensure the price always has two decimal places
}

window.onload = function () {
    const selectedCart = JSON.parse(localStorage.getItem('selectedCart')) || [];
    const cartItemsTable = document.getElementById('cart-items');

    // If no items are selected, show a message
    if (selectedCart.length === 0) {
        cartItemsTable.innerHTML = '<tr><td colspan="5">Your cart is empty. Please select items to proceed.</td></tr>';
        return;
    }

    // Loop through the selected items and create rows for the table
    selectedCart.forEach(item => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td><span class="product-name">${item.name}</span></td>
            <td><span class="product-color">${item.color}</span></td>
            <td><span class="product-quantity">${item.quantity}</td>
            <td><span class="product-price">${formatPeso(item.price)}</td>
            <td><span class="product-total">${formatPeso(item.price * item.quantity)}</td>
        `;
        cartItemsTable.appendChild(row);
    });

    // Calculate subtotal
    const subtotal = selectedCart.reduce((total, item) => total + (item.price * item.quantity), 0);
    const shippingFee = 36.00;
    const totalAmount = subtotal + shippingFee;

    // Add subtotal row
    const subtotalRow = document.createElement('tr');
    subtotalRow.innerHTML = `
        <td colspan="4"><strong>Subtotal</strong></td>
        <td><strong>${formatPeso(subtotal)}</strong></td>
    `;
    cartItemsTable.appendChild(subtotalRow);

    // Add shipping fee row
    const shippingRow = document.createElement('tr');
    shippingRow.innerHTML = `
        <td colspan="4"><strong>Shipping Fee</strong></td>
        <td><strong>${formatPeso(shippingFee)}</strong></td>
    `;
    cartItemsTable.appendChild(shippingRow);

    // Add total row
    const totalRow = document.createElement('tr');
    totalRow.innerHTML = `
        <td colspan="4"><strong>Total</strong></td>
        <td><strong>${formatPeso(totalAmount)}</strong></td>
    `;
    cartItemsTable.appendChild(totalRow);
};

// Handle order submission and send email
document.getElementById('checkout-form').addEventListener('submit', function (event) {
    event.preventDefault();

    // Get form data
    const name = document.getElementById('name').value;
    const email = document.getElementById('email').value;
    const address = document.getElementById('address').value;
    const paymentMethod = document.getElementById('payment-method').value; // New: Get payment method
    const customization = document.getElementById("customization").value || "No customization requested"; // Default message if empty
    const phoneNumber = document.getElementById('phone').value; // Get phone number using the id 'phone'

    // Validate phone number using the HTML5 pattern (11 digits)
const phoneInput = document.getElementById('phone');
    if (!phoneInput.validity.valid) {
        alert('Please enter a valid 11-digit phone number.');
        return;
    }

    // Validate other form inputs
    if (!name || !email || !address || !paymentMethod || !phoneNumber) { // Check if all fields are filled
        alert('Please fill out all required fields and select a payment method.');
        return;
    }

    // Get selected cart data from localStorage
    const selectedCart = JSON.parse(localStorage.getItem('selectedCart')) || [];
    if (selectedCart.length === 0) {
        alert('Your cart is empty. Please add items before checking out.');
        return;
    }

    let cartDetails = '';
    selectedCart.forEach(item => {
        cartDetails += `${item.name} (${item.color}) - ${item.quantity} x ${formatPeso(item.price)}\n`;
    });

    const totalAmount = selectedCart.reduce((total, item) => total + (item.price * item.quantity), 0);

    // Send email via EmailJS
    emailjs.send('service_le3k54m', 'template_k950ffy', {
        name: name,
        email: email,
        address: address,
        cart_details: cartDetails,
        total_amount: formatPeso(totalAmount),
        payment_method: paymentMethod, // New: Send payment method
        customization_details: customization // Include customization in the email
    }).then(function (response) {
        console.log('Success!', response.status, response.text);
        alert('Confirmation email sent!');
        
        window.location.href = 'order-confirmation.html'; // Redirect to order confirmation page
    }, function (error) {
        console.log('Failed...', error);
        alert('Failed to send confirmation email!');
    });
});

</script>
      </script>
    <br>

 
  <br>
  <script>
   // Show the corresponding payment details fields based on selected payment method
function showPaymentFields() {
    var paymentMethod = document.getElementById('payment-method').value;
    var paymentDetails = document.getElementById('payment-details');
    
    // Show payment fields (upload image or reference number) only for GCash
    if (paymentMethod === 'gcash') {
        paymentDetails.style.display = "block";  // Show the upload or reference fields
    } else {
        paymentDetails.style.display = "none";  // Hide fields if payment method is COD or other
    }
}

  </script>

  <script defer src="script.js"></script>
  <footer>
    <div class="footer-content">
      <b><p>&copy; 2024 Knotty Yarn Inc. <br><br> All Rights Reserved.</p></b>
    </div>
  </footer>
</body>
</html>
